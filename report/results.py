import matplotlib.pyplot as plt
import numpy as np

images_per_batch = 64

action_accs = [2.893711741791875, 2.3557781487664626, 3.542941940270822, 3.542941940270822, 3.1348543869411984, 2.6896679651270636, 4.377666481172325, 4.22927100723428, 6.288258208124652, 6.0842144314598405, 8.347245409015025, 8.644036356891114, 8.810981265071415, 8.75533296234465, 9.144871081432017, 9.97959562233352, 9.256167686885549, 10.369133741420887, 9.923947319606752, 10.554628083843443, 10.536078649601187, 8.996475607493972, 8.736783528102393, 10.554628083843443, 8.903728436282693, 10.591726952327955, 9.88684845112224, 9.441662029308107, 10.053793359302542, 9.608606937488407, 10.053793359302542, 9.163420515674273, 9.831200148395473, 9.608606937488407, 10.165089964756074, 9.998145056575774, 10.554628083843443, 9.961046188091263, 9.645705805972918, 10.591726952327955, 9.905397885364495, 10.165089964756074, 9.923947319606752, 9.089222778705249, 9.831200148395473, 10.090892227787053, 9.831200148395473, 9.608606937488407, 9.88684845112224, 9.84974958263773]
action_evaluation = [24.806289196014404, 25.267229795455933, 24.47188639640808, 25.298484086990356, 24.94969153404236, 25.206130266189575, 24.837027311325073, 24.70202112197876, 25.38092613220215, 24.254083156585693, 24.93700337409973, 25.16457462310791, 24.783137559890747, 25.06635284423828, 25.380171060562134, 25.374616146087646, 24.5921368598938, 25.15559697151184, 25.190157890319824, 24.907411098480225, 25.03200602531433, 25.241970539093018, 25.26064372062683, 25.117045640945435, 24.93181014060974, 24.56084179878235, 24.104323625564575, 25.270050525665283, 25.339107990264893, 25.593677282333374, 25.649370431900024, 25.591930389404297, 25.10060477256775, 24.691989421844482, 24.921984434127808, 24.781569004058838, 24.846502780914307, 24.89534640312195, 25.160516500473022, 24.733048915863037, 25.01345920562744, 25.586026668548584, 25.635415077209473, 24.341150522232056, 25.00328803062439, 25.33424210548401, 25.43926429748535, 25.71519422531128, 25.47840118408203, 24.84342050552368]
action_batches = 85
print("ACTION")
print(f"Max acc: {np.array(action_accs).max()}")
print(f"Images per sec: {(action_batches * images_per_batch)/np.array(action_evaluation).mean()}")

birds_accs = [0.6903693476009666, 0.4832585433206766, 0.44874007594062826, 0.5868139454608216, 0.4832585433206766, 0.5177770107007249, 0.5522954780807732, 0.7939247497411116, 0.7248878149810148, 0.5868139454608216, 0.7248878149810148, 1.0355540214014498, 0.9665170866413532, 1.0010355540214015, 1.1045909561615463, 1.2426648256817396, 1.0355540214014498, 0.9319986192613048, 1.173627890921643, 1.2426648256817396, 1.1391094235415948, 1.0355540214014498, 1.070072488781498, 1.3807386952019332, 1.2426648256817396, 0.9665170866413532, 1.070072488781498, 1.173627890921643, 1.3117017604418364, 1.2426648256817396, 1.0355540214014498, 1.070072488781498, 1.1391094235415948, 1.3117017604418364, 1.173627890921643, 1.1045909561615463, 1.173627890921643, 1.070072488781498, 1.2081463583016916, 1.1045909561615463, 1.1391094235415948, 1.173627890921643, 1.173627890921643, 1.173627890921643, 1.2426648256817396, 1.1391094235415948, 1.2081463583016916, 1.2081463583016916, 1.0355540214014498, 1.0355540214014498]
birds_evaluation = [13.446536302566528, 13.567553997039795, 12.941072702407837, 13.493525505065918, 13.82583212852478, 13.763783693313599, 13.124672412872314, 13.542941331863403, 13.228195428848267, 13.017448663711548, 13.067483186721802, 13.52480173110962, 12.890822649002075, 13.260820627212524, 13.194708824157715, 13.582826852798462, 13.711390018463135, 12.957046270370483, 13.34378433227539, 13.78558897972107, 13.34398365020752, 13.274376392364502, 12.78249716758728, 13.442049980163574, 14.02337384223938, 13.505518913269043, 13.709754228591919, 13.773796796798706, 13.939859628677368, 14.13864779472351, 13.756513357162476, 13.275949716567993, 12.9971764087677, 13.392024755477905, 13.434757471084595, 13.0879487991333, 13.285619258880615, 13.440861701965332, 13.672746181488037, 14.112695693969727, 13.515986442565918, 13.429579019546509, 13.752397298812866, 13.653057098388672, 13.134125471115112, 12.418178081512451, 13.601735353469849, 13.344978094100952, 14.045624494552612, 13.935456037521362]
birds_batches = 46
print("BIRDS")
print(f"Max acc: {np.array(birds_accs).max()}")
print(f"Images per sec: {(birds_batches * images_per_batch)/np.array(birds_evaluation).mean()}")


cars_accs = [0.5720681507275215, 0.5471956224350205, 0.5471956224350205, 0.8829747543837831, 1.2063176221862952, 1.7410769804750654, 2.1763462255938317, 2.3380176594950877, 2.002238527546325, 1.7286407163288147, 3.7930605646063924, 4.377564979480164, 3.3204825270488745, 3.507026489242632, 5.695808978982714, 5.397338639472703, 6.243004601417734, 8.02139037433155, 7.001616714339012, 7.946772789454048, 8.916801392861585, 9.973883845292875, 10.508643203581643, 10.371844297972888, 11.826887203084194, 10.309662977241636, 9.973883845292875, 10.732495958214153, 12.374082825519213, 11.640343240890436, 9.389379430419103, 10.831986071384156, 10.060937694316626, 11.72739708991419, 10.96878497699291, 9.986320109439124, 10.720059694067901, 12.697425693321726, 10.39671682626539, 11.926377316254197, 10.881731127969157, 9.140654147494093, 11.46623554284293, 10.508643203581643, 11.030966297724163, 10.135555279194131, 10.570824524312897, 11.789578410645442, 11.105583882601666, 10.334535505534138]
cars_evaluation = [84.6887481212616, 50.37676501274109, 173.42539715766907, 168.3252673149109, 108.29022860527039, 58.215973138809204, 139.89986062049866, 175.0647315979004, 137.91496324539185, 69.44530773162842, 120.6879894733429, 169.62746930122375, 150.67450952529907, 83.42910361289978, 139.3274848461151, 157.0151026248932, 150.61789870262146, 93.54304051399231, 109.89883756637573, 145.5271553993225, 142.22077107429504, 124.47645330429077, 167.2086808681488, 171.09112524986267, 116.59290671348572, 101.88337922096252, 112.11149644851685, 147.40698266029358, 134.14379978179932, 122.27308750152588, 108.17550754547119, 145.99415063858032, 137.5847237110138, 128.96902418136597, 111.872243642807, 138.06291794776917, 130.19355654716492, 130.24592447280884, 119.80756759643555, 136.90789484977722, 135.41642808914185, 132.1590700149536, 120.74567985534668, 131.8231179714203, 136.20573091506958, 127.81130194664001, 123.61560726165771, 127.71620225906372, 135.60996317863464, 129.47201585769653]
cars_batches = 126

print("CARS")
print(f"Max acc: {np.array(cars_accs).max()}")
print(f"Images per sec: {(cars_batches * images_per_batch)/np.array(cars_evaluation).mean()}")



dtd_accs = [2.074468085106383, 3.829787234042553, 3.6702127659574466, 7.446808510638298, 7.819148936170213, 6.01063829787234, 8.670212765957446, 9.202127659574467, 13.085106382978722, 12.712765957446809, 18.03191489361702, 19.680851063829788, 20.79787234042553, 20.851063829787233, 21.54255319148936, 22.393617021276597, 24.73404255319149, 26.329787234042552, 26.914893617021278, 25.053191489361705, 28.45744680851064, 28.24468085106383, 28.936170212765955, 29.627659574468083, 29.20212765957447, 28.936170212765955, 28.723404255319153, 29.680851063829788, 29.627659574468083, 29.414893617021278, 29.308510638297875, 29.308510638297875, 29.521276595744684, 30.425531914893618, 30.106382978723406, 29.840425531914892, 30.372340425531913, 29.521276595744684, 30.26595744680851, 30.425531914893618, 30.159574468085104, 30.106382978723406, 29.25531914893617, 30.106382978723406, 30.0531914893617, 30.531914893617024, 27.76595744680851, 30.106382978723406, 30.425531914893618, 29.78723404255319]
dtd_evaluation = [9.276499271392822, 8.815366744995117, 9.346847295761108, 9.10544204711914, 9.072635412216187, 8.65971827507019, 9.301902055740356, 9.220385313034058, 8.820068597793579, 8.821432828903198, 9.0318021774292, 8.707263708114624, 8.96971583366394, 8.84512710571289, 9.322593212127686, 9.204110383987427, 8.706742525100708, 9.073896169662476, 9.118119478225708, 8.870402574539185, 9.236498355865479, 9.22907304763794, 9.026248693466187, 8.69127869606018, 8.649970054626465, 9.334609508514404, 9.201610803604126, 9.165405750274658, 8.851563930511475, 8.190722227096558, 9.110931396484375, 9.22365951538086, 8.786160945892334, 9.403478384017944, 8.138736486434937, 8.888106107711792, 8.83885145187378, 9.019669771194458, 8.901820421218872, 8.660989761352539, 8.719921588897705, 8.968875408172607, 8.88828444480896, 9.2453453540802, 8.89098834991455, 9.135173082351685, 9.04815125465393, 8.866753339767456, 8.856680393218994, 9.06161117553711]
dtd_batches = 30
print("DTD")
print(f"Max acc: {np.array(dtd_accs).max()}")
print(f"Images per sec: {(dtd_batches * images_per_batch)/np.array(dtd_evaluation).mean()}")



#food_accs = [2.3404255319148937, 2.2340425531914896, 2.553191489361702, 2.393617021276596, 4.361702127659575, 3.1382978723404253, 4.521276595744681, 5.372340425531915, 4.627659574468085, 8.24468085106383, 10.797872340425533, 12.553191489361701, 12.393617021276595, 14.042553191489363, 15.265957446808512, 16.54255319148936, 17.02127659574468, 17.393617021276594, 20.425531914893615, 19.25531914893617, 21.27659574468085, 20.47872340425532, 22.074468085106382, 21.48936170212766, 21.22340425531915, 22.180851063829788, 23.617021276595747, 22.340425531914892, 22.02127659574468, 22.872340425531913, 21.914893617021278, 22.074468085106382, 21.170212765957448, 21.70212765957447, 22.23404255319149, 22.5531914893617, 23.085106382978722, 21.54255319148936, 22.340425531914892, 22.28723404255319, 23.085106382978722, 23.72340425531915, 22.819148936170215, 24.25531914893617, 23.03191489361702, 23.45744680851064, 23.617021276595747, 23.45744680851064, 23.617021276595747, 23.98936170212766]
#food_evaluation = [6.874311685562134, 6.8700926303863525, 6.8878936767578125, 6.883086204528809, 6.899989604949951, 6.893294811248779, 6.905056715011597, 6.885488510131836, 6.870810508728027, 6.888336658477783, 6.878088712692261, 6.912402629852295, 6.868479490280151, 6.881301403045654, 6.87272834777832, 6.891374826431274, 6.886419773101807, 6.895527362823486, 6.887499094009399, 6.887930870056152, 6.894506931304932, 6.895610332489014, 6.867639541625977, 6.908000946044922, 6.896907329559326, 6.860128402709961, 6.9032323360443115, 6.897982120513916, 6.903614044189453, 6.879716634750366, 6.876055002212524, 6.882408618927002, 6.88279128074646, 6.8994386196136475, 6.888418912887573, 6.888108730316162, 6.8837361335754395, 6.895148515701294, 6.906705856323242, 6.902450084686279, 6.88798713684082, 6.88269829750061, 6.879869222640991, 6.8728742599487305, 6.8852691650390625, 6.884130954742432, 6.8989577293396, 6.873324632644653, 6.893601179122925, 6.8771071434021]
food_batches = 1184

plt.plot(np.array([action_accs, birds_accs, cars_accs, dtd_accs]).T)
plt.title("Accuracy on test set by training epoch")
plt.legend(["Action", "Birds", "Cars", "DTD"])
plt.xlabel("Epoch")
# plt.show()
plt.savefig("accs.png")

